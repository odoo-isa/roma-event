<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- FORM View  -->
    <record model='ir.ui.view' id='l10n_it_accounting_entry_form'>
        <field name='name'>l10n_it_accounting_entry.form</field>
        <field name='model'>l10n_it.accounting.entry</field>
        <field name='arch' type='xml'>
            <form string='Accounting Entry' create="false" edit="false" delete="false">
                <header>
                    <field name="state" widget="statusbar" statusbar_visible="open,close"/>
                </header>
                <sheet>
                    <h1>
                        <field name="name" nolabel="1"/>
                    </h1>
                    <group>
                        <group>
                            <field name="partner_id"/>
                            <field name="account_id"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="entry_lines" string="Entry Lines">
                            <field name="accounting_entry_lines">
                                <tree string="Entry Lines" default_order="date,id" decoration-muted="parent_state == 'draft'">
                                    <field name="id" invisible="1"/>
                                    <field name="parent_state" invisible="1"/>
                                    <field name="move_id"/>
                                    <field name="account_id"/>
                                    <field name="name"/>
                                    <field name="ref"/>
                                    <field name="date"/>
                                    <field name="partner_id"/>
                                    <field name="debit" sum="Total Debit"/>
                                    <field name="credit" sum="Total Credit"/>
                                    <field name="full_reconcile_id" optional="show"/>
                                    <field name="date_maturity" optional="show"/>
                                </tree>
                            </field>
                            <group class="oe_subtotal_footer oe_right">
                                <field name="amount"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- TREE View  -->
    <record model='ir.ui.view' id='l10n_it_accounting_entry_tree'>
        <field name='name'>l10n_it.accounting_entry.tree</field>
        <field name='model'>l10n_it.accounting.entry</field>
        <field name='arch' type='xml'>
            <tree string='Accounting Entry' create="false" edit="false" delete="false">
                <field name='name'/>
                <field name="partner_id"/>
                <field name="state"/>
                <field name="amount"/>
            </tree>
        </field>
    </record>

    <!-- TREE View extend  -->
    <record model='ir.ui.view' id='view_move_line_tree_entry'>
        <field name='name'>view.move.line.tree.entry</field>
        <field name='model'>account.move.line</field>
        <field name="inherit_id" ref="account.view_move_line_tree"/>
        <field name='arch' type='xml'>
            <xpath expr="//field[@name='date_maturity']" position="after">
                <field name="accounting_entry_id" optional="hide"/>
            </xpath>
        </field>
    </record>

    <record model='ir.ui.view' id='view_move_line_tree_grouped_entry'>
        <field name='name'>view.move.line.tree.grouped.entry.tree</field>
        <field name='model'>account.move.line</field>
        <field name="inherit_id" ref="account.view_move_line_tree_grouped"/>
        <field name='arch' type='xml'>
            <xpath expr="//field[@name='full_reconcile_id']" position="after">
                <field name="accounting_entry_id" optional="hide"/>
            </xpath>
        </field>
    </record>

    <!-- SEARCH View -->
    <record model="ir.ui.view" id="l10n_it_accounting_entry_search">
        <field name="name">l10n_it.accounting_entry.search</field>
        <field name="model">l10n_it.accounting.entry</field>
        <field name="arch" type="xml">
            <search string="Accounting Entry">
                <field name="name"/>
                <field name="partner_id"/>
                <field name="account_id"/>
                <filter string="Open" name="open" domain="[('state','=','open')]"/>
                <filter string="Close" name="close" domain="[('state','=','close')]"/>
                <separator orientation="vertical"/>
                <group expand="0" string="Group By">
                    <filter string="Partner" name="group_by_partner" domain="[]" context="{'group_by': 'partner_id'}" />
                    <filter string="Account" name="group_by_account" domain="[]" context="{'group_by': 'account_id'}" />
                </group>
            </search>
        </field>
    </record>


    <!-- Action -->
    <record id="action_open_l10n_it_accounting_entry" model="ir.actions.act_window">
        <field name="name">Accounting Entries Management</field>
        <field name="res_model">l10n_it.accounting.entry</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{'search_default_group_by_account':1}</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                In this view is possible see and manage with accounting entries.
                The accounting entries, generally, are created when posted an account move that has account that are
                managed with the accounting entry flag.
            </p>
        </field>
    </record>

    <!-- menu -->
    <menuitem id="l10n_it_accounting_entry_root"
              name="Accounting entries"
              parent="account.menu_finance_entries"
              sequence="2"/>

    <menuitem id="l10n_it_accounting_entry_menu"
              name="Accounting entries"
              parent="l10n_it_accounting_entry.l10n_it_accounting_entry_root"
              action="l10n_it_accounting_entry.action_open_l10n_it_accounting_entry"
              sequence="1"/>

</odoo>