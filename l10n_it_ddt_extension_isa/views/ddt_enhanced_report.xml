<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <template id="report_ddt_enhanced_document">
            <t t-call="web.external_layout">
            <t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)" />
                <div class="row">
                    <div class="col-6">
                        <strong>Shipping Address:</strong><br/>
                        <span t-field="doc.partner_shipping_id.name"/><br/>
                        <span t-field="doc.partner_shipping_id.street"/><br/>
                        <span t-field="doc.partner_shipping_id.zip" />
                        <span t-field="doc.partner_shipping_id.city" />
                        <t t-if="doc.partner_shipping_id.state_id.code">
                            <span class="cell-text" t-esc="'(' + str(doc.partner_shipping_id.state_id.code) + ')'" />
                        </t>
                        <br/>
                        <span class="cell-text" t-field="doc.partner_shipping_id.country_id.name" />
                    </div>
                    <div class="col-6">
                        <strong>To:</strong><br/>
                        <span class="cell-text" t-field="doc.partner_id.name" /><br/>
                        <span class="cell-text" t-field="doc.partner_id.street"/><br/>
                        <span class="cell-text" t-field="doc.partner_id.zip" />
                        <span class="cell-text" t-field="doc.partner_id.city" />
                        <t t-if="doc.partner_id.state_id.code">
                            <span class="cell-text" t-esc="'(' + str(doc.partner_id.state_id.code) + ')'" />
                        </t>
                        <br/>
                        <span class="cell-text" t-field="doc.partner_id.country_id.name" /><br/>
                        <t t-if="doc.partner_id.vat">
                            <span class="cell-text" >
                                VAT N.: <span t-field="doc.partner_id.vat"/>
                            </span>
                        </t>
                        <t t-if="'l10n_it_codice_fiscale' in doc.partner_id.fields_get() and doc.partner_id.l10n_it_codice_fiscale">
                            <span class="cell-text">
                                F.C.: <span t-field="doc.partner_id.l10n_it_codice_fiscale"/>
                            </span>
                        </t>
                    </div>
                </div>
                <br/>

                <div class="page">
                    <h2>
                        Delivery Note #
                        <span t-field="doc.name"/>
                    </h2>
                    <div class="row">
                        <div class="col-4">
                            <strong>Date:</strong><br/>
                            <span t-field="doc.date"/>
                        </div>
                        <div class="col-4">
                            <strong>Reason for Transportation:</strong><br/>
                            <t t-if="doc.transportation_reason_id">
                                <span t-field="doc.transportation_reason_id.name"/>
                            </t>
                            <t t-else="else">
                                <span>---</span>
                            </t>
                        </div>
                        <div class="col-4">
                            <strong>Incoterm:</strong><br/>
                            <t t-if="doc.incoterm_id">
                                <span class="cell-text" t-field="doc.incoterm_id.name"/>
                            </t>
                            <t t-else="else">
                                <span>---</span>
                            </t>
                        </div>
                    </div>
                    <br/>
                    <table class="table table-sm o_main_table">
                        <thead>
                            <tr>
                                <th class="text-left text-nowrap">Default Code</th>
                                <th class="text-left text-nowrap">Description</th>
                                <th class="text-center text-nowrap" groups="uom.group_uom">U.M.</th>
                                <th class="text-right text-nowrap">Q.ty</th>
                                <th class="text-right text-nowrap">Price Unit</th>
                                <th class="text-right text-nowrap">Discount</th>
                                <th class="text-right text-nowrap">Price Subtotal</th>
                            </tr>
                        </thead>
                        <tbody name="body_ddt_line">
                            <t t-foreach="doc.ddt_lines" t-as="ddt_line">
                                <tr>
                                    <td class="text-left">
                                        <span t-field="ddt_line.product_id.default_code" t-if="ddt_line.product_id"/>
                                    </td>
                                    <td class="text-left">
                                        <span t-field="ddt_line.description"/>
                                    </td>
                                    <td class="text-center" groups="uom.group_uom">
                                        <span t-field="ddt_line.uom_id.name"/>
                                    </td>
                                    <td class="text-right text-nowrap">
                                        <span t-field="ddt_line.quantity"/>
                                    </td>
                                    <td class="text-right text-nowrap">
                                        <span t-field="ddt_line.price_unit"/>
                                    </td>
                                    <td class="text-right text-nowrap">
                                        <span t-field="ddt_line.discount"/>
                                    </td>
                                    <td class="text-right text-nowrap">
                                        <span t-field="ddt_line.price_subtotal"/>
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                    <table class="table table-sm">
                        <tr class="border-black o_subtotal">
                            <td name="td_amount_untaxed_label" class="text-right"><strong>Subtotal</strong></td>
                        </tr>
                        <tr>
                            <td name="td_amount_untaxed" class="text-right">
                                <span t-field="doc.amount_untaxed"/>
                            </td>
                        </tr>
                    </table>

                    <br/>
                    <div class="row">
                        <div class="col-12">
                            <strong>Note:</strong><br/>
                            <t t-if="doc.note">
                                <span t-field="doc.note"/>
                            </t>
                            <t t-else="else">
                                <span>---</span>
                            </t>
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-4">
                            <strong>Transportation Method:</strong><br/>
                            <t t-if="doc.transportation_method_id">
                                <span class="cell-text" t-field="doc.transportation_method_id.name"/>
                            </t>
                            <t t-else="else">
                                <span>---</span>
                            </t>
                        </div>
                        <div class="col-4">
                            <strong>Description of Goods:</strong><br/>
                            <t t-if="doc.goods_description_id">
                                <span t-field="doc.goods_description_id.name"/>
                            </t>
                            <t t-else="else">
                                <span>---</span>
                            </t>
                        </div>
                        <div class="col-4">
                            <strong>Date Done:</strong><br/>
                            <t t-if="doc.date_done">
                                <span t-field="doc.date_done" t-options='{"widget": "datetime"}'/>
                            </t>
                            <t t-else="else">
                                <span>---</span>
                            </t>
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-3"/>
                        <div class="col-3">
                            <strong>Weight Net:</strong><br/>
                            <t t-if="doc.weight_net">
                                <span class="cell-text" t-field="doc.weight_net"/>
                            </t>
                            <t t-else="else">
                                <span class="cell-text" >---</span>
                            </t>
                        </div>
                        <div class="col-3">
                            <strong>Weight:</strong><br/>
                            <t t-if="doc.weight">
                                <span class="cell-text" t-field="doc.weight"/>
                            </t>
                            <t t-else="else">
                                <span class="cell-text">---</span>
                            </t>
                        </div>
                        <div class="col-3">
                            <strong>Parcels:</strong><br/>
                            <t t-if="doc.parcels">
                                <span t-field="doc.parcels"/>
                            </t>
                            <t t-else="else">
                                <span class="cell-text">---</span>
                            </t>
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-6">
                            <strong>Carrier's Signature:</strong>
                        </div>
                        <div class="col-6">
                            <strong>Recipient's Signature:</strong>
                        </div>
                    </div>
                </div>
            </t>
        </template>


        <template id="report_ddt_enhanced">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="l10n_it_ddt_extension_isa.report_ddt_enhanced_document" t-lang="doc.partner_id.lang"/>
                </t>
            </t>
        </template>


        <report
            string="DDT Enhanced"
            id="action_report_ddt_enhanced"
            model="l10n_it.ddt"
            report_type="qweb-pdf"
            name="l10n_it_ddt_extension_isa.report_ddt_enhanced"
            file="l10n_it_ddt_extension_isa.report_ddt_enhanced"
        />

    </data>
</odoo>